\chapter{Analyse des données}

\section{Visualisation des données}

Requête utile pour voir la répartition des causes de décés selon le sexe :

\begin{lstlisting}[frame=single]
SELECT sexage.SEX, causes.LABEL, COUNT(*) AS Number
FROM london INNER JOIN
        sexage ON london.SEXAGE = sexage.SEXAGE INNER JOIN
        causes on london.CAUSE = causes.CAUSE
GROUP BY sexage.sex, causes.label
\end{lstlisting}

\section{Séparation des données de sexe et d'age}

    Vu le format des données de la table SexAge, dissocier l'effet du sexe et de l'âge s'avérait hardu.

    Nous avons donc modifié la table en créant deux nouvelles colonnes: Sex, nvarchar qui contiendra le sexe (M/F), et Age,
    nvarchar qui contiendra la tranche d'âge (<1, 10-14, ...).

    Nous avons alors lancé la requête suivante afin de séparer les données de "sexage" sur ces deux colonnes :

    \begin{lstlisting}[frame=single]
UPDATE sexage
SET Sex=LEFT(label, 1), Age=RIGHT(label, LEN(label) - 1);
    \end{lstlisting}

\section{Incohérences dans les nombre de morts}

    En analysant la table des morts de chaque région, nous avons remarqué que la somme des morts par cause de niveau 2 était
    inférieure au nombre de morts par cause de niveau 1 (càd de toutes les causes de mort).

    Cette incohérence peut être montrée sur la table "westmids" (par exemple) avec la requête suivante :

    \begin{lstlisting}[frame=single]
SELECT causes.NIVEAU, SUM(westmids.DEATHS) AS TotalDeaths
FROM westmids INNER JOIN causes ON westmids;CAUSE = causes.CAUSE
GROUP BY causes.NIVEAU
HAVING (causes.NIVEAU = 1) OR (causes.NIVEAU = 2)
    \end{lstlisting}

    Ceci est probablement dû à une erreur lors du remplissage des formulaires (cause de niveau 2 non-remplie).

    La solution qu'on propose est de rajouter une nouvelle cause de mort de niveau 2 représentant une cause indéfinie, afin
    de ne pas sous-estimer le nombre de morts en ignorant ceux dont la cause de niveau 2 n'est pas renseignée.

    \begin{lstlisting}[frame=single]
METTRE LES REQUETES QUI VONT BIEN ICI
    \end{lstlisting}